<template name="activityMap">
  <div class="map">
    {{#constant}}
      <svg width="500" height="500">
        <circle class="callout" cx=-100 cy=-100></circle>
        <g class="circles"></g>
        <g class="labels"></g>
      </svg>
    {{/constant}}
    <div>
      <small class="attribution muted">&copy;
        <a href="http://www.openstreetmap.org/?lat=37.78212&lon=-122.40146&zoom=15&layers=M"
           target="_blank">OpenSxtreetMap</a> contributors</small>
    </div>
  </div>
</template>

<template name="currentActivity">
  {{#if activity}}
    {{#with activity}}
    <div class="story-item" id="{{_id}}">
      <div class="inner">
        <div class="activity story">
          <div class="content">
            {{> storyContent this}}
          </div>
        </div>
        {{> activityControls this}}
        {{> feedItemActions}}
        {{> feedItemComments}}
      </div>
    </div>
    {{/with}}
  {{/if}}
</template>

<template name="activityControls">
  <div class="activity-controls">
    {{#if previousActivity}}
      <div class="previous">
        {{#with previousActivity}}
          {{#if slug}}
            <a href="/{{group.slug}}/{{slug}}">Previous<span class="hide-for-small"> Story</span></a>
          {{else}}
            <a href="/{{group.slug}}">Previous<span class="hide-for-small"> Short</span></a>
          {{/if}}
        {{/with}}
      </div>
    {{else}}
      <div class="previous clear"></div>
    {{/if}}
    {{#if nextActivity}}
      <div class="next">
        {{#with nextActivity}}
          {{#if slug}}
            <a href="/{{group.slug}}/{{slug}}">Previous<span class="hide-for-small">  Story</span></a>
          {{else}}
            <a href="/{{group.slug}}">Previous<span class="hide-for-small"> Short</span></a>
          {{/if}}
        {{/with}}
      </div>
    {{else}}
       <div class="next clear"></div>
    {{/if}}
  </div>
</template>

<template name="storyContent">
    {{#if canRemove}}
      <div class="actions">
        <a href="#" class="remove action"></a>
      </div>
    {{/if}}
    <div class="header">
      <h2>{{title}}</h2>
    </div>
    <div class="content">
      {{#if photoShow}}
        <div class="text intro">
          {{#unless published}}<span class="warning">Unpublished<br /></span>{{/unless}}
          {{#markdown}}{{text}}{{/markdown}}
        </div>
        {{#if hasPhotos}}
          <div class="activity-highlight large">
            {{gallery}}
          </div>
        {{/if}}
      {{else}}
        {{#if hasPhotos}}
          <div class="activity-highlight">
            {{gallery}}
          </div>
        {{/if}}
        <div class="text">
          {{#unless published}}<span class="warning">Unpublished<br /></span>{{/unless}}
          {{#markdown}}{{text}}{{/markdown}}
        </div> 
      {{/if}}             
      <div itemprop="description" style="display: none">{{textPreview}}</div>
    </div>
    <div class="info-section">
      <div class="picture">
        <img src="{{profilePicture owner}}">
      </div>
      <div class="details">
        <div class="owner">{{userName owner}}</div>
        <div class="date">{{dateCreated}}</div>
      </div>
    </div>
</template>

<template name="currentActivityOld">
  {{#if activity}}
    <div class="activity">
      {{#with activity}}
        <div class="story-full" itemscope itemtype="http://schema.org/BlogPosting">
          <div class="header">
            <div class="title">
              <h2 itemprop="name">{{title}}</h2>
            </div>
            <div class="actions">
              {{#if canEdit}}
                <a href="#" class="small button edit">Edit</a>
              {{/if}}
            </div>
          </div>
          <div class="content">
            <div class="inner">
              {{#if photoShow}}
                <div class="text intro">
                  {{#unless published}}<span class="warning">Unpublished<br /></span>{{/unless}}
                  {{#markdown}}{{text}}{{/markdown}}
                </div>
                {{#if hasPhotos}}
                  <div class="activity-highlight large">
                    {{gallery}}
                  </div>
                {{/if}}
              {{else}}
                {{#if hasPhotos}}
                  <div class="activity-highlight">
                    {{gallery}}
                  </div>
                {{/if}}
                <div class="text">
                  {{#unless published}}<span class="warning">Unpublished<br /></span>{{/unless}}
                  {{#markdown}}{{text}}{{/markdown}}
                </div> 
              {{/if}}             
              <cite>{{creatorName}} - {{dateCreated}}</cite>
              <div itemprop="description" style="display: none">{{textPreview}}</div>
            </div>
          </div>
          {{#if published}}
            <div class="share-links">
              <div class="g-plus" data-action="share" data-annotation="none"></div>
              <div class="fb-share">
                <a href="{{facebookShareUrl}}" target="_blank">
                  <i class="foundicon-social-facebook">
                    <p>Share</p>
                  </i>
                </a>
              </div>
            </div>
          {{/if}}
        </div>
      {{/with}}

      <div class="story-comments">
        <div class="inner">
          {{#if anyComments}}
            {{> commentList activity}}
          {{/if}}
        </div>
      </div>
      {{#if currentUser}}
        {{> commentForm activity}}
      {{/if}}
    <div>
  {{/if}}
</template>