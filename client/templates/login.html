<template name="_newLoginButtons">
  <div id="login-buttons" class="login-buttons-dropdown-align-{{align}}">
    {{#if currentUser}}
      {{#if loggingIn}}
        {{! We aren't actually logged in yet; we're just setting Meteor.userId
            optimistically during an at-startup login-with-token. We expose this
            state so other UIs can treat it specially, but we'll just treat it
            as logged out. }}
        {{#if dropdown}}
          {{> _loginButtonsLoggingIn }}
        {{else}}
          <div class="login-buttons-with-only-one-button">
            {{> _loginButtonsLoggingInSingleLoginButton }}
          </div>
        {{/if}}
      {{else}}
        {{> _loginButtonsLoggedIn}}
      {{/if}}
    {{else}}
      {{> _newLoginButtonsLoggedOut}}
    {{/if}}
  </div>
</template>

<template name="_newLoginButtonsLoggedOut">
  {{#if services}} {{! if at least one service is configured }}
    {{#if configurationLoaded}}
      {{#if dropdown}} {{! if more than one service configured, or password is configured}}
        {{> _loginButtonsLoggedOutDropdown}}
      {{else}}
        {{#with singleService}} {{! at this point there must be only one configured services }}
          <div class="login-buttons-with-only-one-button">
            {{#if loggingIn}}
              {{> _loginButtonsLoggingInSingleLoginButton}}
            {{else}}
              {{> _loginButtonsLoggedOutSingleLoginButton}}
            {{/if}}
          </div>
        {{/with}}
      {{/if}}
    {{/if}}
  {{else}}
    <div class="no-services">No login services configured</div>
  {{/if}}
</template>